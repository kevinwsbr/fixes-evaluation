  Note:
Please check the code carefully before running it. It is not tested and should be reviewed by an experienced programmer.

Please note that it is important to use safe programming practices when working with C code, including checking for null pointers and avoiding buffer overflows. It is also important to test your code thoroughly to ensure that it works as expected.