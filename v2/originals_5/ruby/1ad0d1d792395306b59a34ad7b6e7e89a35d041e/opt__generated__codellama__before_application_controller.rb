class ApplicationController < ActionController::Base
  protect_from_forgery with: :exception, prepend: true

  def protect_from_forgery(request)
    # Generate a random token for the current request
    token = SecureRandom.hex(64)

    # Store the token in the session so it can be verified later
    session[:csrf_token] = token

    # Add the token to the form that is generated by your application
    render html: "<form action='/path/to/action' method='post'>" +
      "<input type='hidden' name='authenticity_token' value='#{token}'>" +
      "<button type='submit'>Submit</button>" +
      "</form>", layout: false
  end
end
